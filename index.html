<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OC x Profile</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- ========== AUTHENTICATION CONTAINER ========== -->
    <div id="auth-container">
        <div class="auth-modal">
            <h2 id="auth-title">เข้าสู่ระบบ</h2>
            <form id="auth-form">
                <div class="form-group">
                    <input type="email" id="auth-email" placeholder="อีเมล" required>
                </div>
                <div class="form-group" id="password-group">
                    <input type="password" id="auth-password" placeholder="รหัสผ่าน" required>
                </div>
                
                <p class="forgot-password-link"><a href="#" id="forgot-password-link">ลืมรหัสผ่าน?</a></p>

                <p id="auth-error" class="auth-error"></p>
                <p id="auth-success" class="auth-success"></p>

                <button type="submit" id="login-btn">เข้าสู่ระบบ</button>
                <button type="button" id="signup-btn" style="display: none;">สมัครสมาชิก</button>
                <button type="button" id="reset-password-btn" style="display: none;">ส่งลิงก์รีเซ็ตรหัสผ่าน</button>
            </form>
            <p class="auth-toggle-link">ยังไม่มีบัญชี? <a href="#" id="toggle-to-signup">สมัครสมาชิกที่นี่</a></p>
            <p class="back-to-login-link" style="display: none;"><a href="#" id="back-to-login-link">กลับไปหน้าเข้าสู่ระบบ</a></p>
        </div>
    </div>

    <!-- ========== MAIN APP CONTAINER (SHOWN WHEN LOGGED IN) ========== -->
    <div id="app-container" style="display: none;">
        <!-- ========== NAVIGATION BAR ========== -->
        <nav>
            <div class="nav-left"><i class="fas fa-bars" id="hamburger-btn"></i></div>
            <div class="nav-right">
                <i class="fas fa-pencil-alt" id="toggle-edit-btn"></i>
                <i class="fas fa-plus" id="add-char-btn"></i>
            </div>
        </nav>

        <!-- ========== SIDEBAR ========== -->
        <div class="sidebar" id="sidebar">
            <div> <!-- Top content wrapper -->
                <div class="sidebar-header">
                    <i class="fas fa-user-circle"></i>
                    <span id="sidebar-user-email">User Profile</span>
                </div>
            </div>
            <div> <!-- Bottom content wrapper -->
                <a href="https://docs.google.com/forms/d/e/1FAIpQLSdHEcU5PtZLMZz70pVrZKynPZLSX1RHaPRkYVt0Q76t3-c3qQ/viewform" target="_blank" class="sidebar-link">
                    <i class="fas fa-comment-alt"></i>
                    <span>Feedback</span>
                </a>
                 <a href="#" id="logout-btn" class="sidebar-link">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>ออกจากระบบ</span>
                </a>
            </div>
        </div>
        <div class="sidebar-overlay" id="sidebar-overlay"></div>

        <!-- ========== HEADER ========== -->
        <header><h1>OC x Profile</h1></header>

        <!-- ========== MAIN CONTENT ========== -->
        <main><div class="character-container" id="character-container"><p class="loading-text">กำลังโหลดข้อมูล...</p></div></main>

        <!-- ========== MODALS ========== -->

        <!-- 1. Add/Edit Modal -->
        <div id="add-char-modal" class="modal-overlay">
            <div class="modal-content">
                <span class="close-btn">&times;</span>
                <h2 id="modal-title">Create New Character</h2>
                <form id="add-char-form">
                    <div id="name-image-section">
                        <div class="image-uploader">
                            <input type="file" id="char-image-input" accept="image/*" style="display: none;">
                            <label for="char-image-input" class="image-preview" id="image-preview-box"><i class="fas fa-camera"></i><span>Add Photo</span></label>
                        </div>
                        <div class="form-group"><input type="text" id="first-name" placeholder="First Name"></div>
                        <div class="form-group"><input type="text" id="middle-name" placeholder="Middle Name (Optional)"></div>
                        <div class="form-group"><input type="text" id="last-name" placeholder="Last Name"></div>
                    </div>
                    <div class="modal-tab-container">
                        <div class="modal-tabs">
                            <button type="button" class="tab-button active" data-tab="profile-tab">Profile</button>
                            <button type="button" class="tab-button" data-tab="yumeship-tab">YumeShip</button>
                        </div>
                        <div class="tab-content active" id="profile-tab">
                            <h4>Profile Details</h4>
                            <div id="custom-fields-container"></div>
                            <button type="button" id="add-field-btn">+ Add Detail</button>
                            <div class="form-group" style="margin-top: 20px;">
                                <label>Character Background</label>
                                <textarea id="character-background" placeholder="ใส่ประวัติตัวละครที่นี่..."></textarea>
                            </div>
                        </div>
                        <div class="tab-content" id="yumeship-tab">
                            <!-- เนื้อหาของ YumeShip สามารถเพิ่มได้ที่นี่ -->
                        </div>
                    </div>
                    <button type="submit">Save Character</button>
                </form>
            </div>
        </div>

        <!-- 2. Delete Confirmation Modal -->
        <div id="delete-confirm-modal" class="modal-overlay">
            <div class="modal-content">
                <h3>ยืนยันการลบ</h3>
                <p>คุณต้องการลบตัวละครนี้ใช่หรือไม่?</p>
                <div class="delete-modal-buttons">
                    <button id="confirm-delete-btn">ลบ</button>
                    <button id="cancel-delete-btn">ยกเลิก</button>
                </div>
            </div>
        </div>

        <!-- 3. Book View Modal -->
        <div id="book-view-modal" class="modal-overlay">
            <!-- เนื้อหาของ Book View สามารถเพิ่มได้ที่นี่ -->
        </div>
    </div>

    <!-- FIREBASE SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-storage-compat.js"></script>
    
    <!-- IMAGE COMPRESSION LIBRARY -->
    <script src="https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.1/dist/browser-image-compression.js"></script>

    <script src="script.js"></script>
</body>
</html>